@import 'tailwindcss';
@import 'tw-animate-css';

:root {
  scroll-behavior: smooth;
  --scroll-offset: 96px;
  --problems-sidebar-width: 300px;
}

@media (min-width: 1280px) {
  :root {
    --problems-sidebar-width: 350px;
  }
}

@layer base {
  body {
    background: radial-gradient(ellipse at top, #1e1b4b 0%, #020617 50%);
  }

  @supports (scrollbar-width: thin) {
    * {
      scrollbar-width: thin;
      scrollbar-color: theme('colors.slate.600') transparent;
    }
  }
}

@layer utilities {
  /* Prevents word break */
  .text-no-break {
    white-space: nowrap;
    hyphens: none;
  }

  /* Automatically apply cursor pointer to explicitly interactive elements */
  button:not([disabled]),
  [role='button']:not([disabled]),
  a[href],
  input[type='button']:not([disabled]),
  input[type='submit']:not([disabled]),
  input[type='reset']:not([disabled]),
  input[type='checkbox']:not([disabled]),
  input[type='radio']:not([disabled]),
  label:has(input:not([disabled])),
  label:has(button:not([disabled])),
  [data-clickable='true'],
  .clickable {
    cursor: pointer;
  }

  /* Ensure disabled elements don't show pointer cursor */
  button:disabled,
  [disabled],
  [aria-disabled='true'] {
    cursor: not-allowed;
  }

  /* Override cursor for non-interactive content areas */
  .problem-content,
  .problem-content
    *:not(button):not([role='button']):not(a):not(input):not(label):not([data-clickable]):not(
      .clickable
    ):not([onclick]) {
    cursor: default;
  }
}

html {
  hyphens: auto;
  word-break: normal;
  overflow-wrap: normal;
  scrollbar-gutter: stable;
}

/* Form Inputs & Buttons */
.form-input {
  @apply w-full bg-gradient-to-r from-slate-800/50 to-slate-900/80 border border-slate-600/60 text-slate-100 rounded-lg text-sm px-3 py-2 transition-all duration-200 ease-in-out outline-none;
}
.form-input::placeholder {
  @apply text-slate-500;
}
.form-input:hover {
  @apply border-slate-500/80;
}
.form-input:focus {
  @apply border-indigo-500/60 shadow-[0_0_0_2px_rgba(99,102,241,0.4)];
}
.form-input[aria-invalid='true'] {
  @apply border-red-500/70 shadow-[0_0_0_2px_rgba(239,68,68,0.35)];
}
.form-input[aria-invalid='true']:focus {
  @apply border-red-500/70 shadow-[0_0_0_2px_rgba(239,68,68,0.45)];
}
.form-input.disabled {
  @apply bg-slate-800/20 cursor-not-allowed opacity-60;
}

/* Form Checkbox */
.form-checkbox {
  @apply h-4 w-4 rounded border-slate-500 bg-slate-700 text-indigo-600 transition-colors duration-200 focus-visible:ring-indigo-500;
}
.form-checkbox:disabled {
  @apply cursor-default opacity-50;
}

/*
  Responsive display math:
  - Allow horizontal scrolling instead of breaking long equations.
  - Prevent KaTeX content from wrapping mid-equation.
*/
.math-display {
  @apply my-4 text-center max-w-full;
}

/* Keep each equation on one line and allow horizontal scroll when needed */
.math-display .katex-display {
  /* Keep KaTeX display math as block to preserve eqno/tag layout */
  display: block;
  /* Allow natural KaTeX wrapping; avoid forcing nowrap which can overlap tags */
  white-space: normal;
}

/* Slightly reduce size on very small screens to improve fit */
@media (max-width: 640px) {
  .math-display .katex-display {
    font-size: 0.95rem;
  }
}

/* Custom list marker styles with parentheses and extra spacing */
.marker-roman-paren {
  list-style-type: lower-roman;
}
.marker-roman-paren > li::marker {
  content: '(' counter(list-item, lower-roman) ')\00a0\00a0';
}

.marker-decimal-paren {
  list-style-type: decimal;
}
.marker-decimal-paren > li::marker {
  content: '(' counter(list-item, decimal) ')\00a0\00a0';
}

.marker-alpha-paren {
  list-style-type: lower-alpha;
}
.marker-alpha-paren > li::marker {
  content: '(' counter(list-item, lower-alpha) ')\00a0\00a0';
}

/* Body of math handouts: serif for TeX-like feel, with fluid size */
.article--math {
  font-family: Georgia, 'Times New Roman', ui-serif, serif;
  font-size: clamp(1.0625rem, 0.95rem + 0.35vw, 1.15625rem);
  line-height: 1.7;
  max-width: 85ch;
  text-rendering: optimizeLegibility;
}

/* Keep the default font even inside math articles */
.article--math h1,
.article--math h2,
.article--math h3 {
  font-family:
    'Inter',
    ui-sans-serif,
    system-ui,
    -apple-system,
    'Segoe UI',
    Roboto,
    'Helvetica Neue',
    Arial,
    'Noto Sans',
    sans-serif;
  letter-spacing: -0.01em;
  line-height: 1.2;
  margin-top: 1.6em;
  margin-bottom: 0.6em;
}

/* Paragraph & list rhythm */
.article--math p {
  margin: 0.7em 0;
}
.article--math ol,
.article--math ul {
  margin: 0.8em 0 0.8em 1.25em;
}

/* Gentle inline math balance */
.article--math p .katex,
.article--math p math {
  font-size: 0.98em;
  line-height: 1;
}

/* Compact footnote popovers */
.article--math.footnote-popover {
  font-size: 0.92em;
  line-height: 1.55;
  max-width: 60ch;
}

/* Footnotes rarely need full display-math scale/margins */
.footnote-popover .katex-display > .katex {
  font-size: 1em;
}
.footnote-popover .katex-display {
  margin-block: 0.6rem;
}

/* Keep inline math subtle */
.footnote-popover p .katex,
.footnote-popover p math {
  font-size: 0.98em;
  line-height: 1;
}

/* Display math slightly larger with breathing room */
.katex-display > .katex,
.article--math .math-display {
  font-size: 1.05em;
}
.katex-display {
  margin-block: 1.2rem;
}

/* Class to force the neutral font */
.ui-text {
  font-family:
    'Inter',
    ui-sans-serif,
    system-ui,
    -apple-system,
    'Segoe UI',
    Roboto,
    'Helvetica Neue',
    Arial,
    'Noto Sans',
    sans-serif;
  letter-spacing: -0.005em;
}

/* Align numbers in labels (e.g., Cvičenie 1, 2, 3) */
.ui-nums {
  font-variant-numeric: tabular-nums;
}

/* Slightly comfier paragraph wrapping (Chrome/Safari support) */
@supports (text-wrap: pretty) {
  .article--math p {
    text-wrap: pretty;
  }
}

/* Tighten letter spacing in headings */
.article--math h1,
.article--math h2,
.article--math h3 {
  letter-spacing: -0.012em;
  font-variant-numeric: lining-nums tabular-nums;
}

/* Nicer lists */
.article--math li {
  margin-block: 0.35em;
}
.article--math .card-content p:first-child {
  margin-top: 0.2em;
}

/* Display math on small screens: avoid overflow clipping */
@media (max-width: 640px) {
  .katex-display {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 0.25rem;
  }
}

/* Footnote refs don’t stretch line height */
.article--math sup,
.article--math sub {
  line-height: 0;
}

/* Exercise / proof labels in Inter look great—align numbers nicely */
.ui-text.ui-nums {
  font-variant-numeric: tabular-nums;
}

/* Set the default color for all footnotes within the article context. */
.article--math .footnote-ref {
  color: #7dd3fc; /* text-sky-300 */
}

/*
  Create a more specific rule that overrides the default for any footnote
  that is also inside a .ui-text element (like a badge). This rule wins
  due to higher specificity, and forces the color to be inherited from the parent.
*/
.article--math .ui-text .footnote-ref {
  color: inherit;
}

/* Mobile filter drawer: override SearchFilters fixed positioning and styling */
.mobile-filter-wrapper > div {
  position: static !important;
  width: 100% !important;
  top: auto !important;
  bottom: auto !important;
  height: auto !important;
  max-height: none !important;
  /* Remove card styling to blend with drawer */
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  /* Ensure smooth transitions */
  transition: none !important;
}

/* Problem card math rendering - fluid font with larger math symbols */
.problem-card-math {
  font-family: Georgia, 'Times New Roman', ui-serif, serif;
  font-size: clamp(0.95rem, 0.85rem + 0.3vw, 1.05rem);
  line-height: 1.7;
  text-rendering: optimizeLegibility;
}
.problem-card-math p {
  margin: 0.7em 0;
}
.problem-card-math .katex,
.problem-card-math math {
  font-size: 1.1em;
  line-height: 1;
}
.problem-card-math .math-display {
  font-size: 1.15em;
}

/*  Sonner Toast Customization */
[data-sonner-toaster] {
  /* Position toasts at the bottom center with mobile responsiveness */
  --width: 360px !important;
}
[data-sonner-toast] {
  /* Base glassmorphism styling */
  backdrop-filter: blur(12px) saturate(180%) !important;
  border-radius: 12px !important;
  border-width: 1px !important;
  padding: 12px 16px !important;
  box-shadow:
    0 10px 25px -5px rgba(0, 0, 0, 0.5),
    0 8px 10px -6px rgba(0, 0, 0, 0.4) !important;
  /* Prevent glitchy animations */
  will-change: transform, opacity;
  transform: translateZ(0);
}

/* Success toast - vibrant green with glassmorphism */
[data-sonner-toast][data-type='success'] {
  background: rgba(22, 163, 74, 0.9) !important;
  border-color: rgba(34, 197, 94, 0.3) !important;
  color: rgb(220, 252, 231) !important;
}

/* Error toast - vibrant red */
[data-sonner-toast][data-type='error'] {
  background: rgba(220, 38, 38, 0.9) !important;
  border-color: rgba(239, 68, 68, 0.3) !important;
  color: rgb(254, 226, 226) !important;
}

/* Info toast - vibrant blue */
[data-sonner-toast][data-type='info'] {
  background: rgba(37, 99, 235, 0.9) !important;
  border-color: rgba(59, 130, 246, 0.3) !important;
  color: rgb(219, 234, 254) !important;
}

/* Warning toast - vibrant yellow with dark text for readability */
[data-sonner-toast][data-type='warning'] {
  background: rgba(234, 179, 8, 0.95) !important;
  border-color: rgba(250, 204, 21, 0.4) !important;
  color: rgb(20, 20, 20) !important;
}

/* Loading toast - vibrant orange */
[data-sonner-toast][data-type='loading'] {
  background: rgba(249, 115, 22, 0.9) !important;
  border-color: rgba(251, 146, 60, 0.3) !important;
  color: rgb(254, 237, 227) !important;
}

/* Animated dots for loading toast - appear inline at the end of text */
[data-sonner-toast][data-type='loading'] [data-title],
[data-sonner-toast][data-type='loading'] [data-description],
[data-sonner-toast][data-type='loading'] [data-content],
[data-sonner-toast][data-type='loading'] > div {
  display: inline !important;
}

[data-sonner-toast][data-type='loading'] [data-title]::after,
[data-sonner-toast][data-type='loading'] [data-description]::after {
  content: '';
  display: inline-block;
  vertical-align: baseline;
  margin-left: 4px;
  width: 18px;
  height: 6px;
  position: relative;
  top: -1px;
  background-image:
    radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
    radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
    radial-gradient(circle, currentColor 1.5px, transparent 1.5px);
  background-size: 4px 4px;
  background-position:
    0 center,
    6px center,
    12px center;
  background-repeat: no-repeat;
  animation: loading-dots 1.4s infinite ease-in-out;
}

@keyframes loading-dots {
  0% {
    opacity: 0.4;
  }
  20% {
    opacity: 1;
    background-image:
      radial-gradient(circle, currentColor 2px, transparent 2px),
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px);
  }
  40% {
    opacity: 0.4;
    background-image:
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
      radial-gradient(circle, currentColor 2px, transparent 2px),
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px);
  }
  60% {
    opacity: 1;
    background-image:
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
      radial-gradient(circle, currentColor 2px, transparent 2px);
  }
  80%,
  100% {
    opacity: 0.4;
    background-image:
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px),
      radial-gradient(circle, currentColor 1.5px, transparent 1.5px);
  }
}

/* Toast icon styling */
[data-sonner-toast] [data-icon] {
  margin-right: 12px;
}

/* Toast content */
[data-sonner-toast] [data-content] {
  font-size: 0.875rem !important;
  font-weight: 500 !important;
  line-height: 1.25rem !important;
}

/* Toast title/description */
[data-sonner-toast] [data-title] {
  font-weight: 500 !important;
}

/* Toast close button */
[data-sonner-toast] [data-button] {
  margin-left: 12px;
  opacity: 0.8;
  transition: all 200ms ease;
  background-color: rgba(255, 255, 255, 0.1) !important;
  border-radius: 6px !important;
  padding: 4px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  border: 1px solid rgba(255, 255, 255, 0.15) !important;
}

[data-sonner-toast] [data-button]:hover {
  opacity: 1;
  background-color: rgba(255, 255, 255, 0.2) !important;
  border-color: rgba(255, 255, 255, 0.25) !important;
  transform: scale(1.05);
}

[data-sonner-toast] [data-button]:active {
  transform: scale(0.95);
}
